# 五子棋神经网络项目使用指南

## 📋 目录
1. [环境准备](#环境准备)
2. [项目测试](#项目测试)
3. [模型训练](#模型训练)
4. [模型评估](#模型评估)
5. [游戏对战](#游戏对战)
6. [常见问题](#常见问题)
7. [文件说明](#文件说明)

## 🔧 环境准备

### 1. 安装依赖
```bash
# 安装PyTorch (CPU版本)
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cpu

# 安装其他依赖
pip install numpy matplotlib tqdm
```

### 2. 验证安装
```bash
python -c "import torch; print(f'PyTorch版本: {torch.__version__}')"
python -c "import numpy; print(f'NumPy版本: {numpy.__version__}')"
```

## 🧪 项目测试

### 1. 运行完整测试
```bash
# 进入项目目录
cd d:\Projects\BestGameStrategyOfGomoku\MachineLearning

# 运行神经网络测试
python test_neural_network.py
```

**预期输出：**
```
五子棋神经网络测试
==================================================
=== 测试模块导入 ===
✓ PyTorch版本: 2.7.1+cpu
✓ NumPy版本: 2.2.5
✓ 神经网络模块导入成功
✓ 棋盘模块导入成功

=== 测试网络创建 ===
✓ 网络创建成功
✓ 总参数数量: 110,013
✓ 可训练参数: 110,013

=== 测试前向传播 ===
✓ 输入张量形状: torch.Size([2, 3, 9, 9])
✓ 策略输出形状: torch.Size([2, 81])
✓ 价值输出形状: torch.Size([2, 1])

测试结果: 6/6 通过
✅ 所有测试通过！
```

### 2. 运行单项测试
```bash
# 测试MCTS
python test_mcts_simple.py

# 测试游戏逻辑
python test_game_fix.py
```

## 🚀 模型训练

### 1. 快速训练（测试用）
```bash
# 运行训练脚本
python train_neural_network.py
```

**训练配置说明：**
- **残差块数量**: 4个（可在脚本中修改`num_residual_blocks`）
- **学习率**: 0.001（带自适应调度）
- **批次大小**: 32
- **训练轮数**: 50（可修改`epochs`）
- **早停机制**: 连续10轮无改善自动停止

### 2. 自定义训练参数
编辑 `train_neural_network.py` 文件中的配置：
```python
# 训练配置
config = {
    'num_residual_blocks': 6,  # 增加网络深度
    'epochs': 100,             # 增加训练轮数
    'batch_size': 64,          # 增加批次大小
    'learning_rate': 0.0005,   # 调整学习率
    'train_size': 2000,        # 增加训练数据量
    'val_split': 0.2,          # 验证集比例
    'patience': 15,            # 早停耐心值
    'device': 'cuda' if torch.cuda.is_available() else 'cpu'  # GPU加速
}
```

### 3. 监控训练过程
训练过程中会显示：
- 每轮的损失值（总损失、策略损失、价值损失）
- 学习率变化
- 验证集性能
- 训练历史图表（自动保存为PNG文件）

## 📊 模型评估

### 1. 运行评估脚本
```bash
# 评估训练好的模型
python evaluate_neural_network.py
```

**评估内容：**
- 与MCTS对战测试（100局）
- 策略预测准确性分析
- 价值评估能力测试
- 性能报告生成

### 2. 评估结果解读
```
=== 与MCTS对战结果 ===
神经网络胜率: 45.0%
平均游戏长度: 23.5步

=== 策略预测分析 ===
平均策略熵: 2.34
最佳移动预测准确率: 67.8%

=== 价值评估分析 ===
价值预测标准差: 0.23
价值预测范围: [-0.89, 0.92]
```

## 🎮 游戏对战

### 1. 人机对战
```bash
# 与训练好的AI对战
python play.py
```

### 2. AI自对战
```bash
# 观看AI自己对战
python quick_test.py
```

## ❓ 常见问题

### Q1: 训练过程中出现内存不足
**解决方案：**
```python
# 减少批次大小
config['batch_size'] = 16

# 减少训练数据量
config['train_size'] = 500

# 减少残差块数量
config['num_residual_blocks'] = 2
```

### Q2: 训练速度太慢
**解决方案：**
```python
# 如果有GPU，启用CUDA
config['device'] = 'cuda' if torch.cuda.is_available() else 'cpu'

# 增加批次大小（如果内存允许）
config['batch_size'] = 64

# 减少训练数据量进行快速测试
config['train_size'] = 200
```

### Q3: 模型性能不佳
**解决方案：**
```python
# 增加网络深度
config['num_residual_blocks'] = 8

# 增加训练数据
config['train_size'] = 5000

# 调整学习率
config['learning_rate'] = 0.0001

# 增加训练轮数
config['epochs'] = 200
```

### Q4: 测试失败
**检查步骤：**
1. 确认Python版本（推荐3.8+）
2. 重新安装依赖：`pip install -r requirements.txt`
3. 检查文件路径是否正确
4. 运行：`python test_neural_network.py` 查看具体错误

## 📁 文件说明

### 核心文件
- **`net.py`**: 神经网络架构和训练器
- **`board.py`**: 棋盘逻辑
- **`mcts.py`**: 蒙特卡洛树搜索
- **`game.py`**: 游戏引擎

### 训练和评估
- **`train_neural_network.py`**: 完整训练流程
- **`evaluate_neural_network.py`**: 模型评估系统
- **`train.py`**: 原始训练脚本

### 测试文件
- **`test_neural_network.py`**: 神经网络测试
- **`test_mcts_simple.py`**: MCTS测试
- **`test_game_fix.py`**: 游戏逻辑测试

### 游戏文件
- **`play.py`**: 人机对战
- **`quick_test.py`**: AI自对战演示

### 文档
- **`README_Day2.md`**: 第2天开发总结
- **`开发计划.md`**: 完整开发计划
- **`使用指南.md`**: 本文件

## 🎯 使用建议

### 新手入门流程
1. **环境准备** → 安装依赖
2. **运行测试** → `python test_neural_network.py`
3. **快速训练** → `python train_neural_network.py`（小数据量）
4. **模型评估** → `python evaluate_neural_network.py`
5. **人机对战** → `python play.py`

### 进阶使用流程
1. **调整参数** → 修改训练配置
2. **长时间训练** → 大数据量、多轮次
3. **性能优化** → GPU加速、参数调优
4. **模型对比** → 不同配置的模型评估

### 开发者流程
1. **代码测试** → 运行所有测试文件
2. **功能开发** → 修改核心模块
3. **集成测试** → 完整流程验证
4. **性能分析** → 评估和优化

---

## 📞 技术支持

如果遇到问题，请按以下顺序排查：
1. 查看本使用指南的常见问题部分
2. 运行测试脚本确认环境正常
3. 检查错误日志和输出信息
4. 参考项目文档和代码注释

**祝您使用愉快！** 🎉